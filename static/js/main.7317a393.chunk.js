(this["webpackJsonp@nftbuilder/react-app"]=this["webpackJsonp@nftbuilder/react-app"]||[]).push([[0],{1012:function(e,t){},1017:function(e,t){},1019:function(e,t){},1026:function(e,t){},1038:function(e,t){},1280:function(e,t){},1290:function(e,t){},1320:function(e,t){},1380:function(e,t){},1383:function(e,t){},1420:function(e,t){},1502:function(e,t){},1674:function(e,t){},1676:function(e,t){},1766:function(e,t){},1769:function(e,t){},1770:function(e,t){},1941:function(e,t){},1982:function(e,t){},1995:function(e,t){},2011:function(e,t){},2013:function(e,t){},2034:function(e,t){},2119:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(61),l=a.n(o),c=(a(937),a(585)),i=a(76),s=a(578),d=(a(938),a(2198)),u=a(232),p=a(2191),m=a(2196),h=a(2199),f=a(869),E=a.n(f),g=a(870),v=a(135),b=a(903),y=a(124);function w({address:e,provider:t,price:a,minimized:o,web3Modal:l,loadWeb3Modal:c,logoutOfWeb3Modal:i,blockExplorer:s}){const d=[{value:"tab1",label:"NFT Builder"}],[u,p]=Object(n.useState)(d[0].value),[m,h]=Object(n.useState)(!0),f=()=>{c(),h(!m)},E=e,g=[{value:"1",label:"iExec Sidechain testnet"}],[v,w]=Object(n.useState)(g[0].value),k=[];return l&&(l.cachedProvider?k.push(r.a.createElement(y.a,{key:"logoutbutton",style:{verticalAlign:"top",marginLeft:8,marginTop:4},shape:"round",size:"large",onClick:i},"Logout")):k.push(r.a.createElement(y.a,{key:"loginbutton",style:{verticalAlign:"top",marginLeft:8,marginTop:4},shape:"round",size:"large",onClick:c},"Connect"))),r.a.createElement("div",null,r.a.createElement(b.a,{title:"Datahub",tabs:{values:d,value:u,onSelect:e=>p(e)},login:{isLoggedIn:m,onLoginClick:f,onLogoutClick:f,address:E,onAddressClick:()=>alert("onAddressClick")},network:{values:g,value:v,onSelect:e=>w(e),disabled:m},extraButtons:[{icon:r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},r.a.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.a.createElement("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),r.a.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})),label:"extra button",onClick:()=>alert("clicked")}]}))}var k=a(230),x=a.n(k),S=a(2190),O=a(2193);a(344);const C="47354c4ae0f24d918a987cd667da4f15",j=e=>{for(let t in P)if(P[t].chainId===e)return P[t]},P={localhost:{name:"localhost",color:"#666666",chainId:31337,blockExplorer:"",rpcUrl:"http://"+window.location.hostname+":8545"},mainnet:{name:"mainnet",color:"#ff8b9e",chainId:1,rpcUrl:"https://mainnet.infura.io/v3/"+C,blockExplorer:"https://etherscan.io/"},kovan:{name:"kovan",color:"#7003DD",chainId:42,rpcUrl:"https://kovan.infura.io/v3/"+C,blockExplorer:"https://kovan.etherscan.io/",faucet:"https://gitter.im/kovan-testnet/faucet"},rinkeby:{name:"rinkeby",color:"#e0d068",chainId:4,rpcUrl:"https://rinkeby.infura.io/v3/"+C,faucet:"https://faucet.rinkeby.io/",blockExplorer:"https://rinkeby.etherscan.io/"},ropsten:{name:"ropsten",color:"#F60D09",chainId:3,faucet:"https://faucet.ropsten.be/",blockExplorer:"https://ropsten.etherscan.io/",rpcUrl:"https://ropsten.infura.io/v3/"+C},goerli:{name:"goerli",color:"#0975F6",chainId:5,faucet:"https://goerli-faucet.slock.it/",blockExplorer:"https://goerli.etherscan.io/",rpcUrl:"https://goerli.infura.io/v3/"+C},xdai:{name:"xdai",color:"#48a9a6",chainId:100,price:1,gasPrice:1e9,rpcUrl:"https://dai.poa.network",faucet:"https://xdai-faucet.top/",blockExplorer:"https://blockscout.com/poa/xdai/"},matic:{name:"matic",color:"#2bbdf7",chainId:137,price:1,gasPrice:1e9,rpcUrl:"https://rpc-mainnet.maticvigil.com",faucet:"https://faucet.matic.network/",blockExplorer:"https://explorer-mainnet.maticvigil.com//"},mumbai:{name:"mumbai",color:"#92D9FA",chainId:80001,price:1,gasPrice:1e9,rpcUrl:"https://rpc-mumbai.maticvigil.com",faucet:"https://faucet.matic.network/",blockExplorer:"https://mumbai-explorer.matic.today/"},iExecSidechain:{name:"iExec Test Sidechain",color:"#92D9FA",chainId:133,gasPrice:0,rpcUrl:"https://viviani.iex.ec",faucet:"https://faucet.iex.ec/viviani",blockExplorer:"https://explorer.iex.ec/viviani/"}};var D=a(37);var N=(e,t)=>{const[a,r]=Object(n.useState)(t),[o,l]=function(e,t){const[a,r]=Object(n.useState)(()=>{try{const a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(a){return console.log(a),t}});return[a,t=>{try{const n=t instanceof Function?t(a):t;r(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(n){console.log(n)}}]}("ensCache_"+t);return Object(n.useEffect)(()=>{o&&o.timestamp>Date.now()?r(o.name):e&&(async(e,t)=>{try{const a=await e.lookupAddress(t),n=await e.resolveName(a);if(Object(D.a)(t)===Object(D.a)(n))return a}catch(a){}return 0})(e,t).then(e=>{e&&(r(e),l({timestamp:Date.now()+36e4,name:e}))})},[o,e,t,r,l]),a};const{Text:I}=S.a;function F(e){const t=e.value||e.address,a=N(e.ensProvider,t);if(!t)return r.a.createElement("span",null,r.a.createElement(O.a,{avatar:!0,paragraph:{rows:1}}));let n=t.substr(0,6);a&&a.indexOf("0x")<0?n=a:"short"===e.size?n+="..."+t.substr(-4):"long"===e.size&&(n=t);const o=((e,t)=>`${t||"https://etherscan.io/"}address/${e}`)(t,e.blockExplorer);if(e.minimized)return r.a.createElement("span",{style:{verticalAlign:"middle"}},r.a.createElement("a",{target:"_blank",href:o,rel:"noopener noreferrer"},r.a.createElement(x.a,{seed:t.toLowerCase(),size:8,scale:2})));let l;return l=e.onChange?r.a.createElement(I,{editable:{onChange:e.onChange},copyable:{text:t}},r.a.createElement("a",{target:"_blank",href:o,rel:"noopener noreferrer"},n)):r.a.createElement(I,{copyable:{text:t}},r.a.createElement("a",{target:"_blank",href:o,rel:"noopener noreferrer"},n)),r.a.createElement("span",null,r.a.createElement("span",{style:{verticalAlign:"middle"}},r.a.createElement(x.a,{seed:t.toLowerCase(),size:8,scale:e.fontSize?e.fontSize/7:4})),r.a.createElement("span",{style:{verticalAlign:"middle",paddingLeft:5,fontSize:e.fontSize?e.fontSize:28}},l))}var T=a(889),A=a.n(T),z=a(2202),R=a(2203),L=a(2195),U=a(2192);function K(e){return e.address&&"function"===typeof e.address.toLowerCase?r.a.createElement(x.a,Object.assign({seed:e.address.toLowerCase()},e)):r.a.createElement("span",null)}function _(e){const[t,a]=Object(n.useState)(e.value),[o,l]=Object(n.useState)(!1),c="undefined"!==typeof e.value?e.value:t,i=Object(v.a)(e.ensProvider,c),s=r.a.createElement("div",{style:{marginTop:4,cursor:"pointer"},onClick:()=>{l(!o)}},r.a.createElement(L.a,{count:r.a.createElement(z.a,{style:{fontSize:9}})},r.a.createElement(R.a,{style:{fontSize:18}}))," ","Scan"),{ensProvider:d,onChange:u}=e,p=Object(n.useCallback)(async e=>{if("undefined"!==typeof e){let n=e;if(n.indexOf(".eth")>0||n.indexOf(".xyz")>0)try{const e=await d.resolveName(n);e&&(n=e)}catch(t){}a(n),"function"===typeof u&&u(n)}},[d,u]),m=o?r.a.createElement("div",{style:{zIndex:256,position:"absolute",left:0,top:0,width:"100%"},onClick:()=>{l(!1)}},r.a.createElement(A.a,{delay:250,resolution:1200,onError:e=>{console.log("SCAN ERROR",e),l(!1)},onScan:e=>{if(e){console.log("SCAN VALUE",e);let t=e;t.indexOf("/")>=0&&(t=t.substr(t.lastIndexOf("0x")),console.log("CLEANED VALUE",t)),l(!1),p(t)}},style:{width:"100%"}})):"";return r.a.createElement("div",null,m,r.a.createElement(U.a,{autoComplete:"off",autoFocus:e.autoFocus,placeholder:e.placeholder?e.placeholder:"address",prefix:r.a.createElement(K,{address:c,size:8,scale:3}),value:i||c,addonAfter:s,onChange:e=>{p(e.target.value)}}))}function M(e){const[t,a]=Object(n.useState)(e.price?"USD":"ETH"),[o,l]=Object(n.useState)(),[c,i]=Object(n.useState)(),s="undefined"!==typeof e.value?e.value:c,d=n=>e.price?r.a.createElement("div",{style:{cursor:"pointer"},onClick:()=>{if("USD"===t)a("ETH"),l(s);else if(a("USD"),s){const t=""+(parseFloat(s)*e.price).toFixed(2);l(t)}else l(s)}},n):"";let u,p;return"USD"===t?(u="$",p=d("USD \ud83d\udd00")):(u="\u039e",p=d("ETH \ud83d\udd00")),Object(n.useEffect)(()=>{s||l("")},[s]),r.a.createElement(U.a,{placeholder:e.placeholder?e.placeholder:"amount in "+t,autoFocus:e.autoFocus,prefix:u,value:o,addonAfter:p,onChange:async a=>{const n=a.target.value;if("USD"===t){const t=parseFloat(n);if(t){const a=t/e.price;i(a),"function"===typeof e.onChange&&e.onChange(a),l(n)}else l(n)}else i(n),"function"===typeof e.onChange&&e.onChange(n),l(n)}})}var q=a(106);function W(e){const[t,a]=Object(n.useState)(!0),[o,l]=Object(n.useState)();Object(v.b)(()=>{(async()=>{if(e.address&&e.provider)try{const t=await e.provider.getBalance(e.address);l(t)}catch(t){console.log(t)}})()},e.pollTime?e.pollTime:11999);let c=parseFloat("0.00"),i=o;if("undefined"!==typeof e.balance&&(i=e.balance),"undefined"!==typeof e.value&&(i=e.value),i){const e=Object(q.b)(i);parseFloat(e).toFixed(2),c=parseFloat(e)}let s=c.toFixed(4);const d=e.price||e.dollarMultiplier;return d&&t&&(s="$"+(c*d).toFixed(2)),r.a.createElement("span",{style:{verticalAlign:"middle",fontSize:e.size?e.size:24,padding:8,cursor:"pointer"},onClick:()=>{a(!t)}},s)}var B=a(292),H=a(2206),G=a(3),$=a(911),V=a(891);function J(e,t,a){if("undefined"!==typeof e)return async t=>{const n=e.getSigner(),r=await e.getNetwork(),o={dappId:"0b58206a-f3c0-4701-a62f-73c7243e8c77",system:"ethereum",networkId:r.chainId,transactionHandler:e=>{console.log("HANDLE TX",e)}},l=Object(V.a)(o);let c="";r.name&&r.chainId>1&&(c=r.name+".");let i="https://"+c+"etherscan.io/tx/";100===r.chainId&&(i="https://blockscout.com/poa/xdai/tx/");try{let e;if(t instanceof Promise?e=await t:(t.gasPrice||(t.gasPrice=0),t.gasLimit||(t.gasLimit=Object(G.i)(12e4)),console.log("RUNNING TX",t),e=await n.sendTransaction(t)),console.log("RESULT:",e),console.log("Notify",l),[1,3,4,5,42,100].indexOf(r.chainId)>=0){const{emitter:t}=l.hash(e.hash);t.on("all",e=>({onclick:()=>window.open((a||i)+e.hash)}))}else $.a.info({message:"Transaction Sent",description:e.hash,placement:"bottomRight"});return e}catch(s){console.log(s),console.log("Transaction Error:",s.message),$.a.error({message:"Transaction Error",description:s.message})}}}var X=a(2204),Y=a(2205),Q=a(2194),Z=a(2187),ee=a(584),te=a.n(ee),ae=a(348);const{Text:ne,Paragraph:re}=S.a;function oe(e){const t=Object(v.d)(e.provider),a=e.address||t,[o,l]=Object(n.useState)(),[c,i]=Object(n.useState)(),[s,d]=Object(n.useState)(),[p,m]=Object(n.useState)(),[h,f]=Object(n.useState)(),E=e.provider?r.a.createElement(B.a,{title:"Wallet"},r.a.createElement(X.a,{onClick:()=>{l(!o)},rotate:-90,style:{padding:7,color:e.color?e.color:"",cursor:"pointer",fontSize:28,verticalAlign:"middle"}})):"";let g,b,y;if(c)g=r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(ne,{copyable:!0},a)),r.a.createElement(te.a,{value:a,size:"450",level:"H",includeMargin:!0,renderAs:"svg",imageSettings:{excavate:!1}})),b=r.a.createElement(u.a,{key:"hide",onClick:()=>{i("")}},r.a.createElement(R.a,null)," Hide"),y=r.a.createElement(u.a,{key:"hide",onClick:()=>{f(a),i("")}},r.a.createElement(Y.a,null)," Private Key");else if(h){let t=localStorage.getItem("metaPrivateKey"),n=new ae.ethers.Wallet(t);if(n.address!==a)g=r.a.createElement("div",null,r.a.createElement("b",null,"*injected account*, private key unknown"));else{let a={},o=[];for(var w in a[n.address]=!0,o.push(r.a.createElement("div",{style:{fontSize:16,padding:2,backgroundStyle:"#89e789"}},r.a.createElement("a",{href:"/pk#"+t},r.a.createElement(F,{minimized:!0,address:n.address,ensProvider:e.ensProvider})," ",n.address.substr(0,6)))),localStorage)if(w.indexOf("metaPrivateKey_backup")>=0){console.log(w);let t=localStorage.getItem(w),n=new ae.ethers.Wallet(t);a[n.address]||(a[n.address]=!0,o.push(r.a.createElement("div",{style:{fontSize:16}},r.a.createElement("a",{href:"/pk#"+t},r.a.createElement(F,{minimized:!0,address:n.address,ensProvider:e.ensProvider})," ",n.address.substr(0,6)))))}g=r.a.createElement("div",null,r.a.createElement("b",null,"Private Key:"),r.a.createElement("div",null,r.a.createElement(ne,{copyable:!0},t)),r.a.createElement("hr",null),r.a.createElement("i",null,"Point your camera phone at qr code to open in",r.a.createElement("a",{target:"_blank",href:"https://xdai.io/"+t,rel:"noopener noreferrer"},"burner wallet"),":"),r.a.createElement(te.a,{value:"https://xdai.io/"+t,size:"450",level:"H",includeMargin:!0,renderAs:"svg",imageSettings:{excavate:!1}}),r.a.createElement(re,{style:{fontSize:"16"},copyable:!0},"https://xdai.io/"+t),o?r.a.createElement("div",null,r.a.createElement("h3",null,"Known Private Keys:"),o,r.a.createElement(u.a,{onClick:()=>{let e=window.localStorage.getItem("metaPrivateKey");e&&window.localStorage.setItem("metaPrivateKey_backup"+Date.now(),e);const t=ae.ethers.Wallet.createRandom()._signingKey().privateKey;window.localStorage.setItem("metaPrivateKey",t),window.location.reload()}},"Generate")):"")}b=r.a.createElement(u.a,{key:"receive",onClick:()=>{i(a),f("")}},r.a.createElement(R.a,null)," Receive"),y=r.a.createElement(u.a,{key:"hide",onClick:()=>{f(""),i("")}},r.a.createElement(Y.a,null)," Hide")}else{const t={padding:10};g=r.a.createElement("div",null,r.a.createElement("div",{style:t},r.a.createElement(_,{autoFocus:!0,ensProvider:e.ensProvider,placeholder:"to address",address:p,onChange:m})),r.a.createElement("div",{style:t},r.a.createElement(M,{price:e.price,value:s,onChange:e=>{d(e)}}))),b=r.a.createElement(u.a,{key:"receive",onClick:()=>{i(a),f("")}},r.a.createElement(R.a,null)," Receive"),y=r.a.createElement(u.a,{key:"hide",onClick:()=>{f(a),i("")}},r.a.createElement(Y.a,null)," Private Key")}return r.a.createElement("span",null,E,r.a.createElement(Q.a,{visible:o,title:r.a.createElement("div",null,a?r.a.createElement(F,{address:a,ensProvider:e.ensProvider}):r.a.createElement(Z.a,null),r.a.createElement("div",{style:{float:"right",paddingRight:25}},r.a.createElement(W,{address:a,provider:e.provider,dollarMultiplier:e.price}))),onOk:()=>{i(),f(),l(!o)},onCancel:()=>{i(),f(),l(!o)},footer:[y,b,r.a.createElement(u.a,{key:"submit",type:"primary",disabled:!s||!p||c,loading:!1,onClick:()=>{const t=J(e.provider);let a;try{a=Object(q.d)(""+s)}catch(n){a=Object(q.d)(""+parseFloat(s).toFixed(8))}t({to:p,value:a}),l(!o),i()}},r.a.createElement(H.a,null)," Send")]},g))}function le(e){const[t,a]=Object(n.useState)();let o;o=t&&"function"===typeof t.toLowerCase?r.a.createElement(x.a,{seed:t.toLowerCase(),size:8,scale:4}):r.a.createElement("div",null);const l=Object(v.a)(e.ensProvider,t),c=Object(n.useCallback)(async t=>{if("undefined"!==typeof t){let r=t;if(r.indexOf(".eth")>0||r.indexOf(".xyz")>0)try{const t=await e.ensProvider.resolveName(r);t&&(r=t)}catch(n){}a(r)}},[e.ensProvider]),i=J(e.localProvider);return r.a.createElement("span",null,r.a.createElement(U.a,{size:"large",placeholder:e.placeholder?e.placeholder:"local faucet",prefix:o,value:l||t,onChange:e=>{c(e.target.value)},suffix:r.a.createElement(B.a,{title:"Faucet: Send local ether to an address."},r.a.createElement(u.a,{onClick:()=>{i({to:t,value:Object(q.d)("0.01")}),a("")},shape:"circle",icon:r.a.createElement(H.a,null)}),r.a.createElement(oe,{color:"#888888",provider:e.localProvider,ensProvider:e.ensProvider,price:e.price}))}))}var ce=a(907);const ie={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out"},se={borderColor:"#fcd15a"},de={borderColor:"#fcd15a"},ue={borderColor:"#ff1744"};function pe(e){const{acceptedFiles:t,getRootProps:a,getInputProps:o,isFocused:l,isDragAccept:c,isDragReject:i}=Object(ce.a)(),s=t.map(e=>r.a.createElement("li",{key:e.path},e.path," - ",e.size," bytes"));Object(n.useEffect)(()=>{t&&e.parentCallback(t)},[t]);const d=Object(n.useMemo)(()=>({...ie,...l?se:{},...c?de:{},...i?ue:{}}),[l,c,i]);return r.a.createElement("section",{className:"container"},r.a.createElement("div",{className:"container"},r.a.createElement("div",a({style:d}),r.a.createElement("input",o()),r.a.createElement("p",null,"Drag 'n' drop your dataset file here, or click to select a file"))),r.a.createElement("aside",null,r.a.createElement("h4",null,"File"),r.a.createElement("ul",null,s)))}var me=a(115),he=a(2189),fe=a(350),Ee=a(896);const ge=Object(he.a)({container:{width:"70%",paddingTop:"50px",paddingLeft:"20px",flexDirection:"column",flex:1},input:{paddingTop:"25px",width:600,maxWidth:800},divider:{marginTop:"20px",marginLeft:"0px",height:"200px"},dividerlast:{marginTop:"20px",marginLeft:"0px",height:"300px"},dividertee:{height:"40px"},deploydataset:{paddingTop:"400px"},pushtEncryptionkeytosms:{paddingTop:"200px"},publishteedatasetorder:{paddingTop:"200px"},orderbook:{paddingTop:"200px"}});function ve({address:e,readProvider:t,writeProvider:a,contracts:o,tx:l,iexec:c}){const[i,s]=Object(n.useState)(""),[d,u]=Object(n.useState)([]),[p,m]=Object(n.useState)(""),[h,f]=Object(n.useState)(""),[E,g]=Object(n.useState)(""),[v,b]=Object(n.useState)(""),[w,k]=Object(n.useState)(""),[x,S]=Object(n.useState)(""),O=e=>S(e.target.value),[C,j]=Object(n.useState)(""),[P,D]=Object(n.useState)("0x0000000000000000000000000000000000000000"),[N,I]=Object(n.useState)("0x0000000000000000000000000000000000000000"),[F,T]=Object(n.useState)(""),[A,z]=Object(n.useState)(""),[R,L]=Object(n.useState)([]),[U,K]=Object(n.useState)(!1),[_,M]=Object(n.useState)(""),[q,W]=Object(n.useState)(""),[B,H]=Object(n.useState)(!1),[G,$]=Object(n.useState)(!1),[V,J]=Object(n.useState)(!1),[X,Y]=Object(n.useState)(!1),[Q,Z]=Object(n.useState)(""),[ee,te]=Object(n.useState)([]),[ae,ne]=Object(n.useState)(""),re=Object(n.useRef)(null),oe=Object(n.useRef)(null),le=Object(n.useRef)(null),ce=e=>new Promise(t=>setTimeout(t,e)),ie=ge();return r.a.createElement("div",{className:ie.container},r.a.createElement("div",{className:"prepareencryptionkey"},r.a.createElement("h2",null,"Prepare Confidential NFT"),r.a.createElement(y.a,{onClick:async()=>{try{const e=c.dataset.generateEncryptionKey();s(e),m(e)}catch(e){console.log(e)}}},"Generate Encryption Key"),r.a.createElement(me.a,{className:ie.input,label:"Encryption key",value:p,onChange:e=>m(e.target.value),placeholder:"base64 encoded aes 256 key"}),r.a.createElement(pe,{parentCallback:e=>{u(e)}}),U?r.a.createElement(fe.a,null):r.a.createElement(y.a,{onClick:async()=>{try{K(!0);const e=d[0];if(!e)throw Error("No file selected");L([r.a.createElement("p",null,"Reading File ",e.name," ")]),console.log("Reading "+e.name);const t=await new Promise((t,a)=>{const n=new FileReader;n.readAsArrayBuffer(e),n.onload=e=>t(e.target.result),n.onerror=()=>a(Error("Failed to read file: "+n.error)),n.onabort=()=>a(Error("Failed to read file: aborted"))});L(t=>[...t,r.a.createElement("p",null,"Encrypting ",e.name," ")]);const a=await c.dataset.encrypt(t,i),n=await c.dataset.computeEncryptedFileChecksum(a);L(e=>[...e,r.a.createElement("p",null,"Uploading encrypted file to IPFS ")]);const o="/ipfs/"+(await Object(Ee.a)(a)).toString(),l="https://ipfs.io"+o;f(e.name),g(o),b(n),L(e=>[...e,r.a.createElement("p",null,"Checking file on IPFS on ",r.a.createElement("a",{href:l},l)," ")]),await ce(5e3),await fetch(l).then(e=>{if(!e.ok)throw Error("Failed to load uploaded file at "+l)}),K(!1),L(e=>[...e,r.a.createElement("p",null,"File encrypted and uploded to IPFS (checksum ",n,") ")]),await ce(4e3),re.current.scrollIntoView({block:"end",behavior:"smooth"})}catch(e){console.log(e)}}},"Encrypt and Upload File"),r.a.createElement("div",null,R.map((e,t)=>r.a.createElement("div",{key:t},e)))),r.a.createElement("div",{className:ie.deploydataset},r.a.createElement("h2",null,"Deploy Confidential NFT"),r.a.createElement(me.a,{className:ie.input,label:"NFT Name",value:h,onChange:e=>f(e.target.value),placeholder:"Dataset name"}),r.a.createElement(me.a,{className:ie.input,label:"File url/ipfs",value:E,onChange:e=>g(e.target.value),placeholder:"Dataset Name"}),r.a.createElement(me.a,{className:ie.input,label:"File checksum",value:v,onChange:e=>b(e.target.value),placeholder:"encrypted file sha256sum"}),B?r.a.createElement(fe.a,null):r.a.createElement(y.a,{onClick:async()=>{try{H(!0);const e=await c.wallet.getAddress(),t=h,a=E,n=v,{address:r}=await c.dataset.deployDataset({owner:e,name:t,multiaddr:a,checksum:n});H(!1),M("Dataset deployed at address "+r),k(p),S(r),await ce(4e3),oe.current.scrollIntoView({block:"end",behavior:"smooth"})}catch(e){console.log(e)}}},"Deploy DataSet"),r.a.createElement("p",null,_)),r.a.createElement("div",{className:ie.divider,id:"deploydataset",ref:re}),r.a.createElement("div",{className:ie.pushtEncryptionkeytosms},r.a.createElement("h2",null,"Deploy Encryption Key"),r.a.createElement(me.a,{className:ie.input,label:"Encryption Key",value:w,onChange:e=>k(e.target.value),placeholder:"Dataset Key"}),r.a.createElement(me.a,{className:ie.input,label:"Dataset address",value:x,onChange:O,placeholder:"Dataset address"}),r.a.createElement(y.a,{onClick:async()=>{try{await c.dataset.pushDatasetSecret(x,w),W("Encryption key pushed for datastet "+x),await ce(4e3),le.current.scrollIntoView({block:"end",behavior:"smooth"})}catch(e){console.log(e)}}},"Push Encryption Key"),r.a.createElement("p",null,q)),r.a.createElement("div",{className:ie.divider,ref:oe}),r.a.createElement("div",{className:ie.publishteedatasetorder},r.a.createElement("h2",null,"Grant Usage of your Confidential NFT"),r.a.createElement(me.a,{className:ie.input,label:"Dataset address",value:x,onChange:O,placeholder:"Dataset address"}),r.a.createElement(me.a,{className:ie.input,label:"#Access",value:C,onChange:e=>j(e.target.value),placeholder:"1"}),r.a.createElement(me.a,{className:ie.input,label:"Restrict to app",value:P,onChange:e=>D(e.target.value),placeholder:"0x0000000000000000000000000000000000000000"}),r.a.createElement(me.a,{className:ie.input,label:"Restrict to user",value:N,onChange:e=>I(e.target.value),placeholder:"0x0000000000000000000000000000000000000000"}),r.a.createElement(y.a,{onClick:async()=>{try{const e=x,t=0,a=C,n=P,r=N,o=["tee"],l=await c.order.signDatasetorder(await c.order.createDatasetorder({dataset:e,datasetprice:t,volume:a,apprestrict:n,requesterrestrict:r,tag:o})),i=await c.order.publishDatasetorder(l);console.log("Order published with hash "+i),T(i),alert("Order published with hash "+i)}catch(e){console.log(e)}}},"Authorize"),r.a.createElement(me.a,{className:ie.input,label:"Order hash",value:F,onChange:e=>T(e.target.value),placeholder:"Order hash"}),r.a.createElement(y.a,{onClick:async()=>{try{const{order:e}=await c.orderbook.fetchDatasetorder(F),{txHash:t}=await c.order.cancelDatasetorder(e);alert(`Order canceled (tx:${t})`)}catch(e){console.log(e)}}},"Cancel Authorization")),r.a.createElement("div",{className:ie.dividertee,ref:le}),r.a.createElement("div",{className:ie.orderbook},r.a.createElement("h2",null,"Run in demo app"),r.a.createElement(y.a,{onClick:async()=>{try{const e=await c.storage.defaultStorageLogin();await c.storage.pushStorageToken(e,{forceUpdate:!0}),(async()=>{try{const e=await c.storage.checkStorageTokenExists(await c.wallet.getAddress());Z(e?"initialized":"not initialized")}catch(e){console.log(e)}})()}catch(e){console.log(e)}finally{J(!0)}},disabled:V},"Init Storage"),r.a.createElement("p",null,Q),r.a.createElement(me.a,{className:ie.input,label:"Dataset address",value:x,onChange:O,placeholder:"Dataset address"}),G?r.a.createElement(fe.a,null):r.a.createElement(y.a,{onClick:async()=>{try{$(!0);const e="0x4674570aAb12ad082857F3262c2F8D4DF09Aa498",t=x,a=await c.wallet.getAddress(),{orders:n}=await c.orderbook.fetchAppOrderbook(e,{minTag:["tee"]}),o=n&&n[0]&&n[0].order;if(!o)throw Error("no apporder found for app "+e);const l=(await c.orderbook.fetchDatasetOrderbook(t,{requester:a})).orders[0].order,i=await c.orderbook.fetchWorkerpoolOrderbook({workerpool:"0x5210cD9C57546159Ac60DaC17B3e6cDF48674FBD",app:e,requester:a,minTag:["tee"]});console.log(i.orders[0].order);const s=i.orders[0].order,d=await c.order.createRequestorder({app:e,appmaxprice:o.appprice,dataset:t,datasetmaxprice:l.datasetprice,workerpoolmaxprice:s.workerpoolprice,requester:a,volume:1,params:{iexec_developer_logger:!0},tag:["tee"],category:s.category}),u=await c.order.signRequestorder(d);console.log(l);const{dealid:p}=await c.order.matchOrders({apporder:o,datasetorder:l,requestorder:u,workerpoolorder:s}),m="https://explorer.iex.ec/viviani/deal/"+p,h=await c.deal.show(p);z(h.tasks[0]),te([r.a.createElement("p",null,"submitted deal ! check deal on ",r.a.createElement("a",{href:m},m)," ")]),ne("Task Running! this can take up to 5 minutes before downloading the task result"),$(!1)}catch(e){console.log(e)}}},"Run App"),r.a.createElement("div",null,ee[0]),r.a.createElement("div",null,ae),r.a.createElement(me.a,{className:ie.input,label:"Task id",value:A,onChange:e=>z(e.target.value),placeholder:"Task id"}),X?r.a.createElement(fe.a,null):r.a.createElement(y.a,{onClick:async()=>{try{Y(!0);const e=await c.task.fetchResults(A);console.log(e);const t=await e.blob();console.log(t);const a=A+".zip",n=document.createElement("a");n.href=window.URL.createObjectURL(t),n.click(),Y(!1),window.navigator.msSaveOrOpenBlob&&window.navigator.msSaveOrOpenBlob(t,a)}catch(e){console.log(e),Y(!1),alert(e.message)}}},"Download Task Result")),r.a.createElement("div",{className:ie.dividerlast}))}const be=P.iExecSidechain,ye=be.blockExplorer;const we=new E.a({cacheProvider:!0,providerOptions:{}}),ke=async()=>{await we.clearCachedProvider(),setTimeout(()=>{window.location.reload()},1)};window.ethereum&&window.ethereum.on("chainChanged",e=>{setTimeout(()=>{window.location.reload()},1)});var xe=function(e){var t;const[a,o]=Object(n.useState)(),[l,f]=Object(n.useState)(),E=Object(v.d)(a);let b=null===a||void 0===a||null===(t=a._network)||void 0===t?void 0:t.chainId,y=null===be||void 0===be?void 0:be.chainId,k="";var x,S;k=(null===be||void 0===be?void 0:be.chainId)&&b&&be.chainId!==b?r.a.createElement("div",{style:{zIndex:2,position:"absolute",right:0,top:60,padding:16}},r.a.createElement(d.a,{message:"\u26a0\ufe0f Wrong Network",description:r.a.createElement("div",null,"You have"," ",r.a.createElement("b",null,null===(x=j(b))||void 0===x?void 0:x.name,"(",b,")")," ","selected and you need to be on"," ",r.a.createElement("b",null,null===(S=j(null===be||void 0===be?void 0:be.chainId))||void 0===S?void 0:S.name," (",y,")"),"."),type:"error",closable:!1})):r.a.createElement("div",{style:{zIndex:-1,position:"absolute",right:154,top:28,padding:16,color:be.color}},be.name);const O=Object(n.useCallback)(async()=>{let e;if(!window.ethereum)throw Error("Need to install MetaMask");e=window.ethereum,e.on("chainChanged",e=>window.location.reload()),e.on("accountsChanged",e=>window.location.reload()),await window.ethereum.request({method:"eth_requestAccounts"}),window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:"0x85",chainName:"iExec Test Sidechain",nativeCurrency:{name:"xRLC",symbol:"xRLC",decimals:18},rpcUrls:["https://viviani.iex.ec"],blockExplorerUrls:["https://blockscout-viviani.iex.ec"]}]});try{await window.ethereum.request({method:"eth_requestAccounts"})}catch(a){throw Error("User denied access",a)}const t=new s.a(e);o(t),f(new g.IExec({ethProvider:e},{isNative:!0,smsURL:"https://v7.sms.debug-tee-services.viviani.iex.ec"}))},[o]);Object(n.useEffect)(()=>{we.cachedProvider&&O()},[O]);const[C,P]=Object(n.useState)();Object(n.useEffect)(()=>{P(window.location.pathname)},[P]);let D="";const N=a&&a.connection&&"localhost"===be.name,[I,F]=Object(n.useState)(!1);return!I&&a&&a._network&&31337===a._network.chainId&&(D=r.a.createElement("div",{style:{padding:16}},r.a.createElement(u.a,{type:"primary",onClick:()=>{F(!0)}},r.a.createElement("span",{role:"img","aria-label":"funds"},"\ud83d\udcb0")," Grab funds from the faucet ",r.a.createElement("span",{role:"img","aria-label":"gas"},"\u26fd\ufe0f")))),r.a.createElement("div",{className:"App"},k,r.a.createElement(c.a,{basename:"/confidential-nft"},r.a.createElement(p.a,{style:{textAlign:"center"},selectedKeys:[C],mode:"horizontal"},r.a.createElement(p.a.Item,{key:"/"},r.a.createElement(c.b,{onClick:()=>{P("/")},to:"/"}))),r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/"},E?r.a.createElement(ve,{address:E,writeProvider:a,iexec:l}):r.a.createElement("div",{style:{paddingTop:"130px"}},"Connect your wallet to use the Dapp!")))),r.a.createElement("div",{style:{position:"fixed",textAlign:"right",left:0,right:0,top:0}},r.a.createElement(w,{address:E,provider:a,web3Modal:we,loadWeb3Modal:O,logoutOfWeb3Modal:ke,blockExplorer:ye}),D),r.a.createElement("div",{style:{position:"fixed",textAlign:"left",left:0,bottom:20,padding:10}},r.a.createElement(m.a,{align:"middle",gutter:[4,4]},r.a.createElement(h.a,{span:24},N?r.a.createElement(le,{localProvider:a}):""))))},Se=a(906);l.a.render(r.a.createElement(Se.a,null,r.a.createElement(xe,null)),document.getElementById("root"))},504:function(e,t){},551:function(e,t){},896:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return o}));var n=a(897),r=a.n(n);const o=async(t,{ipfsGateway:a="https://ipfs.io"}={})=>{const n=await r.a.create();try{const{cid:r}=await n.add(t);return await n.pin.add(r,{timeout:1e4}).catch(e=>console.log("Ipfs add pin failed",e)),await(async(t,{ipfsGateway:a="https://ipfs.io"}={})=>{const n=`${a}${"/ipfs/"+t.toString()}`,r=await fetch(n);if(!r.ok)throw Error("Failed to load content from "+n);const o=await r.arrayBuffer();return e.from(o)})(r.toString(),{ipfsGateway:a}),await n.stop(),r.toString()}catch(o){throw"function"===typeof n.stop&&await n.stop(),o}}}).call(this,a(13).Buffer)},898:function(e,t){},899:function(e,t){},932:function(e,t,a){e.exports=a(2119)},937:function(e,t,a){},938:function(e,t,a){},944:function(e,t){},961:function(e,t){},963:function(e,t){},965:function(e,t){},973:function(e,t){},975:function(e,t){},985:function(e,t){},987:function(e,t){}},[[932,1,2]]]);
//# sourceMappingURL=main.7317a393.chunk.js.map